## Gonka

官网：https://gonka.ai/

代币经济学：https://gonka.ai/tokenomics.pdf

Github：https://github.com/gonka-ai/gonka/

Discord：https://discord.com/invite/RADwCT2U6R

X：https://x.com/gonka_ai

官方 OTC：https://t.me/gonka_otc 

场外 OTC：https://hex.exchange/otc/gonka38261697

收益计算：https://hashiro.tech/gonka

浏览器：https://gonkascan.com/





## 教程

快速入门：https://gonka.ai/zh/host/quickstart/#_17

多节点：https://gonka.ai/host/multiple-nodes/



#### 1.创建账户密钥 (冷钱包)

https://github.com/gonka-ai/gonka/releases

`inferenced` CLI 用于本地账户管理与网络操作。可创建/管理 Gonka 账户、注册主机并执行多种网络操作。

```sh
## 创建密钥 - 按提示输入密码，至少 8 位
./inferenced keys add gonka-account-key --keyring-backend file
```



```ini
## 示例输出
root@i-576a782ow7i9vpq3a07bh7ya3:~# ./inferenced keys add gonka-account-key --keyring-backend file
Enter keyring passphrase (attempt 1/3):
Re-enter keyring passphrase:

- address: gonka1zs04qud0wnca4ryp4vu7888nfr3gl5q9hhaf7e
  name: gonka-account-key
  pubkey: '{"@type":"/cosmos.crypto.secp256k1.PubKey","key":"AhS9XnXzax6fxxxxv9gE3uLwAaOC"}'
  type: local


**Important** write this mnemonic phrase in a safe place.
It is the only way to recover your account if you ever forget your password.

catalog conduct obtain snake toast proud xxx
```



#### 2.下载部署文件

```sh
git clone https://github.com/gonka-ai/gonka.git -b main
cd gonka/deploy/join

## 复制配置模板，并按以下注释修改
cp config.env.template config.env
```



```ini
## 文件	说明
config.env	网络节点的环境变量配置
docker-compose.yml	启动网络节点的 Docker Compose 文件
docker-compose.mlnode.yml	启动 ML 节点的 Docker Compose 文件
node-config.json	网络节点使用的配置，描述该节点所管理的推理节点
```



```ini
## 手动为您的节点定义唯一标识符。
export KEY_NAME=test-01

## 设置密码以加密服务器上 file 密钥环后端中存储的 ML 运营密钥。最少 8 位
export KEYRING_PASSWORD=12345678

## 设置节点在机器上可用的端口（默认为 8000）
export API_PORT=8000
export API_SSL_PORT=8443

## 设置节点可访问的公共 URL（例如 http://your-domain.com:8000 或 http://your-ip:8000）。
export PUBLIC_URL=http://<HOST>:<PORT>

## 设置节点的 P2P 外部地址（例如 tcp://your-domain.com:5000 或 tcp://your-ip:5000）。
export P2P_EXTERNAL_ADDRESS=tcp://<HOST>:<PORT>

## 使用上面创建的账户密钥的公钥（"key": 后面的值，不带引号）。
export ACCOUNT_PUBKEY=<ACCOUNT_PUBKEY_FROM_STEP_ABOVE>
export NODE_CONFIG=./node-config.json

## 设置 Hugging Face 模型缓存路径。将其设置为可写的本地目录（例如 ~/hf-cache）。
export HF_HOME=/mnt/shared
export SEED_API_URL=http://node2.gonka.ai:8000
export SEED_NODE_RPC_URL=http://node2.gonka.ai:26657
export SEED_NODE_P2P_URL=tcp://node2.gonka.ai:5000
export DAPI_API__POC_CALLBACK_URL=http://api:9100
export DAPI_CHAIN_NODE__URL=http://node:26657
export DAPI_CHAIN_NODE__P2P_URL=http://node:26656
export RPC_SERVER_URL_1=http://node1.gonka.ai:26657
export RPC_SERVER_URL_2=http://node2.gonka.ai:26657
export PORT=8080
export INFERENCE_PORT=5050
export KEYRING_BACKEND=file
```



```sh
## 下面示例会在本地与服务器命令中引用这些环境变量（如 $PUBLIC_URL、$ACCOUNT_PUBKEY、$SEED_API_URL）。请在每个将要执行命令的终端会话中运行一次 source config.env。
source config.env
```



#### 3.预下载模型权重到 Hugging Face 缓存

```sh
## 安装依赖
if ! command -v pip3 &> /dev/null; then
    apt install -y python3-pip
fi

if ! command -v hf &> /dev/null; then
    pip3 install -U "huggingface_hub[cli]"
fi

## 下载模型
source config.env
export HF_ENDPOINT=https://hf-mirror.com
mkdir -p $HF_HOME
hf download Qwen/Qwen3-32B-FP8
# hf download Qwen/Qwen2.5-7B-Instruct
```



#### 4.拉取 Docker 镜像

```sh
cd gonka/deploy/join

source config.env
docker compose -f docker-compose.yml -f docker-compose.mlnode.yml pull
```



#### 5.启动初始化服务

先启动完成密钥配置所需的核心服务（暂不启动 API）：

我们先启动这些容器，因为：

- **`tmkms`**：生成并安全管理用于验证者注册的共识密钥（Consensus Key）
- **`node`**：连接区块链并提供 RPC 端点以获取共识密钥
- **`api`**：此阶段暂不启动，因为下一步需要在该容器内创建 ML 运营密钥

```sh
## 进入工作目录
cd gonka/deploy/join

## 启动
source config.env && docker compose up tmkms node -d --no-deps

## 通过日志验证初始化服务是否成功
# docker compose logs tmkms node -f
docker logs -f node
docker logs -f tmkms
```



#### 6.在服务器上创建 ML 操作密钥 (热钱包) 

- 每台服务器仅执行一次
- 会将当前目录中的 `.inference/` 挂载到容器内的 **/root/.inference**

**在 `api` 容器**内使用 `file` keyring 后端创建暖密钥（便于程序化访问）。密钥将存储在映射到容器 `/root/.inference` 的持久卷中：

```sh
## 进入容器
source config.env && docker compose run --rm --no-deps -it api /bin/sh

## 1.生成密钥，需要输入密码，最少 8 位
printf '%s\n%s\n' "$KEYRING_PASSWORD" "$KEYRING_PASSWORD" | inferenced keys add "$KEY_NAME" --keyring-backend file

## 2.注册主机
inferenced register-new-participant $DAPI_API__PUBLIC_URL $ACCOUNT_PUBKEY --node-address $DAPI_CHAIN_NODE__SEED_API_URL
```



```ini
## 输出结果 - 生成密钥
- address: gonka1fnvgq0quyl3sxsszcfpxkvqs46nfksqwvfgwd9
  name: test-001
  pubkey: '{"@type":"/cosmos.crypto.secp256k1.PubKey","key":"A0PQZjfj43BLf7i7xxx15tsG6p1NaFqBJZ"}'
  type: local


**Important** write this mnemonic phrase in a safe place.
It is the only way to recover your account if you ever forget your password.

uncle wheat belt rug sugar behind poverty xxx
```



```ini
## 输出结果 - 注册主机
No consensus key provided, attempting to auto-fetch from chain node...
Successfully auto-fetched and validated consensus key from chain node
Registering new participant:
  Node URL: http://183.251.64.217:8000
  Account Address: gonka1zs04qud0wnca4ryp4vu7888nfr3gl5q9hhaf7e
  Account Public Key: AhS9XnXzax6fMzMVvjpIQROBZC1VLjNMv9gE3uLwAaOC
  Validator Consensus Key: h6Al3OHj5mX51r8K+J4oZaF1T3RhyGlY5wY2EGhWarA= (auto-fetched)
  Seed Node Address: http://node2.gonka.ai:8000
Sending registration request to http://node2.gonka.ai:8000/v1/participants
Response status code: 200
Participant registration successful.
Waiting for participant to be available (timeout: 30 seconds)...
..
Found participant with pubkey: AhS9XnXzax6fMzMVvjpIQROBZC1VLjNMv9gE3uLwAaOC (balance: 0)
Participant is now available at http://node2.gonka.ai:8000/v1/participants/gonka1zs04qud0wnca4ryp4vu7888nfr3gl5q9hhaf7e
```



#### 7.在本地机器上授权

- 将 `gonka-account-key` 替换为上一步中生成的热钱包地址

```sh
./inferenced tx inference grant-ml-ops-permissions \
gonka-account-key \
gonka1yv70thncszyj8thjy3fkg88lceuh4z3qu7dcyk \
--from gonka-account-key \
--keyring-backend file \
--gas 2000000 \
--node $SEED_API_URL/chain-rpc/
```



```ini
## 输出结果
root@i-576a782ow7i9vpq3a07bh7ya3:~# ./inferenced tx inference grant-ml-ops-permissions \
gonka-account-key \
gonka1p3zdx87ndu7kdf08znz80hmzg6mchrhtq2a7ln \
--from gonka-account-key \
--keyring-backend file \
--gas 2000000 \
--node $SEED_API_URL/chain-rpc/
Enter keyring passphrase (attempt 1/3):
Detected chain-id: gonka-mainnet
Transaction sent with hash: 530BA78FAE5D42B38EE8DB093B5231F5C0BFD52227812B48CE48A66602DEFBCB
Waiting for transaction to be included in a block...

Transaction confirmed successfully!
Block height: 1383524
```



#### 8.启动完整节点

```sh
source config.env && docker compose -f docker-compose.yml -f docker-compose.mlnode.yml up -d
```



#### 9.验证节点状态

http://36.189.234.197:18026/dashboard/gonka/validator

http://36.189.234.197:18026/dashboard/gonka/validator/gonkavaloper1zs04qud0wnca4ryp4vu7888nfr3gl5q9thvwf5

http://36.189.234.197:18026/dashboard/gonka/account/gonka1zs04qud0wnca4ryp4vu7888nfr3gl5q9hhaf7e

```sh
## 检查本地节点状态
curl http://0.0.0.0:26657/status | jq

## 检查参与者列表 - 将下列的 IP 换成前边设置的自己的外网 IP
curl http://node2.gonka.ai:8000/v1/participants | jq -r '.participants[] | select(.url=="http://124.232.149.247:8000")'

## 将返回自己的公钥，这表示你的地址已被包含在参与者列表中  - 替换为自己的冷钱包地址
curl http://node2.gonka.ai:8000/v1/participants/gonka1ftcldunt8k4t52ku4ypfqfht96xyunf2as2lhu

## 当你的节点完成一次「计算证明（Proof of Compute）」阶段（每 24 小时一次）后，可访问：
http://node2.gonka.ai:8000/v1/epochs/current/participants
```





## 附录： NVIDIA 容器工具包

```sh
## 准备仓库
curl -fsSL https://nvidia.github.io/libnvidia-container/gpgkey | sudo gpg --dearmor -o /usr/share/keyrings/nvidia-container-toolkit-keyring.gpg

curl -s -L https://nvidia.github.io/libnvidia-container/stable/deb/nvidia-container-toolkit.list | \
sed 's#deb https://#deb [signed-by=/usr/share/keyrings/nvidia-container-toolkit-keyring.gpg] https://#g' | \
sudo tee /etc/apt/sources.list.d/nvidia-container-toolkit.list

## 安装
sudo apt-get update
sudo apt-get install -y nvidia-container-toolkit
sudo nvidia-ctk runtime configure --runtime=docker
sudo systemctl restart docker

## 校验
docker run --rm --gpus all  nvidia/cuda:13.0.2-cudnn-devel-ubuntu22.04 nvidia-smi
```

